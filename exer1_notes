#----------------ΕΥΡΕΣΗ  PID ΜΕΣΩ ΟΝΟΜΑΤΟΣ----------#

#include <stdio.h>
#include <string.h>
#include <dirent.h>
#include <stdlib.h>
#include <signal.h>
#include <ctype.h>

int main() {
    DIR *dir = opendir("/proc");
    struct dirent *entry;

    while ((entry = readdir(dir)) != NULL) {
        if (!isdigit(entry->d_name[0])) continue;  // μόνο directories που είναι PID
        char path[256];
        snprintf(path, sizeof(path), "/proc/%s/comm", entry->d_name);

        FILE *f = fopen(path, "r");
        if (!f) continue;

        char name[256];
        if (fgets(name, sizeof(name), f) != NULL) {
            name[strcspn(name, "\n")] = 0; // αφαιρεί newline
            if (strcmp(name, "myprogram") == 0) {
                pid_t pid = atoi(entry->d_name);
                kill(pid, SIGUSR1);       // στέλνει το σήμα
                printf("Στάλθηκε SIGUSR1 σε PID %d\n", pid);
            }
        }
        fclose(f);
    }
    closedir(dir);
    return 0;
}


#--------------ΕΥΡΕΣΗ ΚΑΤΑΣΤΑΣΗΣ ΑΛΛΗΣ ΔΙΕΡΓΑΣΙΑΣ ΑΠΟ PID------------#

#include <stdio.h>
#include <stdlib.h>
#include <signal.h>

int main() {
    FILE *fp = popen("pgrep myprogram", "r");
    if (!fp) return 1;

    int pid;
    while (fscanf(fp, "%d", &pid) == 1) {
        kill(pid, SIGUSR1);
        printf("Στάλθηκε SIGUSR1 σε PID %d\n", pid);
    }
    pclose(fp);
    return 0;
}

#--------------------ΑΠΟΡΙΑ ch 4.----------------#

read(4, "", 1)  εξηγησε μου το δευτερο ορισμα και να μπορω να γραψω αυτη την εντολη

#-------------------ΛΥΣΗ CH.6--------------------#
#include <stdio.h>
#include <unistd.h>
#include <fcntl.h>

int main() {
    char *args[] = {"/home/mike/Documents/mike/OSLab/1st Exercise/riddle-20250930-0/riddle", NULL};
    char *env[]  = {NULL};
    int fd_first[2], fd_second[2];

    pipe(fd_first);
    dup2(fd_first[0],33);
    dup2(fd_first[1],34);

    pipe(fd_second);
    dup2(fd_second[0],53);
    dup2(fd_second[1],54);

    execve("/home/mike/Documents/mike/OSLab/1st Exercise/riddle-20250930-0/riddle", args, env);
}

#------------Ch 9---------#
nc -l 49842 //open server which listens to port 49842
//Ανοιγω άλλο terminal και τρεχω riddle που ειναι ο client

#----------Ch 12-----------#
Κάνω pause riddle (Cntrl-Z)
Πηγαίνω /tmp και βρίσκω το αρχειο που μολις δημιουργηθηκε (ls -l)
Επικολλώ το ονομα στο aux3
Τρεχω aux3 και δίνω τον ζητουμενο χαρακτήρα
Και fg στο riddle

